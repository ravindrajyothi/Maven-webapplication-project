//scripted pipeline starts with node
node
{
    def mavenHome=tool name: "maven-3.9.9"
// from here we need open stage tag and write content with in stage and we can take different stages    
    stage('checkout')
    {
        git branch: 'development', url: 'https://github.com/ravindrajyothi/Maven-webapplication-project.git'
    }
    stage('Compile')
    {
        sh "${mavenHome}/bin/mvn clean package"
    }
    stage('Build Stage')
    {
    sh "${mavenHome}/bin/mvn clean package"
    }
    stage('SQ Report')
    {
        sh "${mavenHome}/bin/mvn clean sonar:sonar package"
    }
    stage('Nexus Backup')
    {
    sh "${mavenHome}/bin/mvn clean deploy"
    }
    stage('Deploy to Tomcat')
    {
        echo "Deploying WAR file using curl..."

        sh """
            curl -u ravindra:password \
            --upload-file /var/lib/jenkins/workspace/Ravi/target/maven-web-application.war \
            "http://52.207.135.214:9090/manager/text/deploy?path=/maven-web-application&update=true"
        """
    }
}
